name: VPS-GIGABIT-FINAL-FIX
on: workflow_dispatch

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Cai dat Tailscale
        run: |
          curl -fsSL https://tailscale.com/install.sh | sh > /dev/null 2>&1
          # Lenh nay se tu login bang Key ban da luu trong Secrets
          sudo tailscale up --authkey=${{ secrets.TAILSCALE_AUTHKEY }} --accept-dns=false

      - name: 2. Thiet lap SSH & Mat khau
        run: |
          sudo apt update && sudo apt install -y openssh-server > /dev/null 2>&1
          # Mat khau la: vps9999
          echo "runner:vps9999" | sudo chpasswd
          sudo service ssh start

      - name: 3. HIEN THI THONG TIN DANG NHAP
        run: |
          # Lay IP tu Tailscale va in ra man hinh
          IP_ADDR=$(tailscale ip -4)
          echo "=========================================="
          echo "ğŸš€ VPS CUA BAN DA SAN SANG!"
          echo "ğŸ“ IP/HOST : $IP_ADDR"
          echo "ğŸ‘¤ USER     : runner"
          echo "ğŸ”‘ PASS     : vps9999"
          echo "ğŸšª PORT     : 22"
          echo "=========================================="

      - name: 4. Duy tri (6h)
        run: sleep 21600
